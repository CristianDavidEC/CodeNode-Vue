import{u as X,s as zt,b as At,r as Mt,c as at,_ as Ht}from"./AlertSave.e840d497.js";import{m as Rt,p as $t,r as ht,o as D,c as st,a as g,b as x,d as W,t as lt,u as P,_ as It,g as U,q as kt,s as qt,i as Bt,x as it,f as _t,j as Nt,y as Ot,z as yt,h as dt,A as rt,B as ct,w as pt,v as ft,n as tt,C as Pt,D as Vt,E as jt}from"./index.be736750.js";const Dt={width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",role:"img",focusable:"false"};function G(b,m){return{name:b,render(){return Rt("svg",Object.assign(Object.assign({},Dt),{innerHTML:m}))}}}const bt=G("BIconArrowRepeat",'<path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/><path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>'),Wt=G("BIconBoxArrowInRight",'<path fill-rule="evenodd" d="M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"/><path fill-rule="evenodd" d="M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>'),Ft=G("BIconBoxes",'<path d="M7.752.066a.5.5 0 0 1 .496 0l3.75 2.143a.5.5 0 0 1 .252.434v3.995l3.498 2A.5.5 0 0 1 16 9.07v4.286a.5.5 0 0 1-.252.434l-3.75 2.143a.5.5 0 0 1-.496 0l-3.502-2-3.502 2.001a.5.5 0 0 1-.496 0l-3.75-2.143A.5.5 0 0 1 0 13.357V9.071a.5.5 0 0 1 .252-.434L3.75 6.638V2.643a.5.5 0 0 1 .252-.434L7.752.066ZM4.25 7.504 1.508 9.071l2.742 1.567 2.742-1.567L4.25 7.504ZM7.5 9.933l-2.75 1.571v3.134l2.75-1.571V9.933Zm1 3.134 2.75 1.571v-3.134L8.5 9.933v3.134Zm.508-3.996 2.742 1.567 2.742-1.567-2.742-1.567-2.742 1.567Zm2.242-2.433V3.504L8.5 5.076V8.21l2.75-1.572ZM7.5 8.21V5.076L4.75 3.504v3.134L7.5 8.21ZM5.258 2.643 8 4.21l2.742-1.567L8 1.076 5.258 2.643ZM15 9.933l-2.75 1.571v3.134L15 13.067V9.933ZM3.75 14.638v-3.134L1 9.933v3.134l2.75 1.571Z"/>'),Tt=G("BIconCalculator",'<path d="M12 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h8zM4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4z"/><path d="M4 2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-2zm0 4a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm0 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm0 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm3-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm0 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm0 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm3-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm0 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-4z"/>'),Ut=G("BIconDashSquare",'<path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/>'),Xt=G("BIconDiagram3Fill",'<path fill-rule="evenodd" d="M6 3.5A1.5 1.5 0 0 1 7.5 2h1A1.5 1.5 0 0 1 10 3.5v1A1.5 1.5 0 0 1 8.5 6v1H14a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-1 0V8h-5v.5a.5.5 0 0 1-1 0V8h-5v.5a.5.5 0 0 1-1 0v-1A.5.5 0 0 1 2 7h5.5V6A1.5 1.5 0 0 1 6 4.5v-1zm-6 8A1.5 1.5 0 0 1 1.5 10h1A1.5 1.5 0 0 1 4 11.5v1A1.5 1.5 0 0 1 2.5 14h-1A1.5 1.5 0 0 1 0 12.5v-1zm6 0A1.5 1.5 0 0 1 7.5 10h1a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 8.5 14h-1A1.5 1.5 0 0 1 6 12.5v-1zm6 0a1.5 1.5 0 0 1 1.5-1.5h1a1.5 1.5 0 0 1 1.5 1.5v1a1.5 1.5 0 0 1-1.5 1.5h-1a1.5 1.5 0 0 1-1.5-1.5v-1z"/>'),Yt=G("BIconPercent",'<path d="M13.442 2.558a.625.625 0 0 1 0 .884l-10 10a.625.625 0 1 1-.884-.884l10-10a.625.625 0 0 1 .884 0zM4.5 6a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zm7 6a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>'),Jt=G("BIconPlusSquare",'<path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>'),Zt=G("BIconPrinter",'<path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/><path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>'),Gt=G("BIconShuffle",'<path fill-rule="evenodd" d="M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.624 9.624 0 0 0 7.556 8a9.624 9.624 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.595 10.595 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.624 9.624 0 0 0 6.444 8a9.624 9.624 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5z"/><path d="M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192zm0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192z"/>'),Kt=G("BIconSlashSquare",'<path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M11.354 4.646a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708l6-6a.5.5 0 0 1 .708 0z"/>'),Qt=G("BIconXSquare",'<path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>'),te={class:"absolute bottom-0 border-t max-w-full w-full p-3 font-normal"},ee={class:"inline-flex font-semibold"},ne={__name:"FooterInfo",setup(b){const m=X(),i=$t(()=>m.nodesProgram.length);return(y,w)=>{const v=ht("font-icon");return D(),st("footer",te,[g("h1",null,[x(v,{icon:"fa-solid fa-code"}),W(" "+lt(P(m).nameProgram),1)]),g("h1",null,"# "+lt(P(m).idProgram),1),g("h1",ee,[x(P(Xt),{class:"mr-2 text-xl"}),W(" "+lt(P(i))+" Nodes ",1)])])}}};const oe=b=>(kt("data-v-a4077097"),b=b(),qt(),b),se={class:"w-56 border-r h-screen bg-color","aria-label":"Sidebar"},ie={class:"py-4 text-white min-h-screen relative"},ae={class:"space-y-2 overflow-y-auto"},le={class:"flex border-b mx-3"},de=oe(()=>g("h1",{class:"font-bold text-2xl tracking-tight text-white mb-1"}," Code:Node ",-1)),re=W(" Variable "),ce=W(" Assign "),ue=W(" Math Operation "),he=W(" Logic Operation "),pe=W(" Cycle "),fe=W(" Print "),me={__name:"SidebarMenu",setup(b){const m=i=>{i.dataTransfer.setData("node",i.target.getAttribute("data-node"))};return(i,y)=>{const w=ht("font-icon"),v=ht("router-link");return D(),st("aside",se,[g("div",ie,[g("ul",ae,[x(v,{to:"/"},{default:U(()=>[g("div",le,[x(w,{icon:"fa-solid fa-laptop-code",size:"2x",class:"mr-3"}),de])]),_:1}),g("li",{class:"py-3 border-b mx-3 px-4",draggable:"true",onDragstart:y[0]||(y[0]=h=>m(h)),"data-node":"variable"},[x(w,{icon:"fa fa-cubes"}),re],32),g("li",{class:"py-3 border-b mx-3 px-4",draggable:"true",onDragstart:y[1]||(y[1]=h=>m(h)),"data-node":"assign"},[x(w,{icon:"fa-solid fa-arrow-right-to-bracket"}),ce],32),g("li",{class:"py-3 border-b mx-3 px-4",draggable:"true",onDragstart:y[2]||(y[2]=h=>m(h)),"data-node":"math"},[x(w,{icon:"fa fa-calculator"}),ue],32),g("li",{class:"py-3 border-b mx-3 px-4",draggable:"true",onDragstart:y[3]||(y[3]=h=>m(h)),"data-node":"logic"},[x(w,{icon:"fa-solid fa-code-merge"}),he],32),g("li",{class:"py-3 border-b mx-3 px-4",draggable:"true",onDragstart:y[4]||(y[4]=h=>m(h)),"data-node":"cicle"},[x(w,{icon:"fa-solid fa-code-compare"}),pe],32),g("li",{class:"py-3 border-b mx-3 px-4",draggable:"true",onDragstart:y[5]||(y[5]=h=>m(h)),"data-node":"print"},[x(w,{icon:"fa-solid fa-print"}),fe],32),x(ne)])])])}}},_e=It(me,[["__scopeId","data-v-a4077097"]]),ge=X(),Ct=b=>{let m="";for(const i of b){const{parentNode:y,pythonCode:w,type:v}=i;!y&&v!=="MathOperation"&&(m+=`${w} 
`)}ge.pythonCode=m};const ve={class:"w-full"},we={class:"flex items-center justify-between bg-color text-white py-2"},ye={class:"w-full flex justify-between px-32 font-bold self-center"},be=W(" Save "),Ce=W(" Update "),xe=W(" Execute "),Re=W(" To Python "),Ie={class:"px-5 py-1 rounded-full border-2 transition duration-150 hover:bg-blue-900"},Be=W(" Help "),Ne={__name:"HeaderBoard",setup(b){const m=X(),i=Bt("emitter"),y=()=>Ct(m.nodesProgram),w=()=>{i.emit("saveProgram"),zt(h)},v=()=>{i.emit("saveProgram"),At(h)},h=e=>{const n={status:e,messageOk:"El programa se ha Guardado con Exito!",messageFall:"Tenemos Problemas al Guardar el Programa"};i.emit("showNotification",n)},t=()=>{Ct(m.nodesProgram),Mt()};return(e,n)=>{const s=ht("font-icon");return D(),st("header",ve,[g("nav",we,[g("div",ye,[g("button",{class:"px-5 py-1 rounded-full border-2 transition duration-150 hover:bg-blue-900",onClick:w},[x(s,{icon:"fa-solid fa-floppy-disk"}),be]),g("button",{class:"px-5 py-1 rounded-full border-2 transition duration-150 hover:bg-blue-900",onClick:v},[x(s,{icon:"fa-solid fa-pen-to-square"}),Ce]),g("button",{class:"px-5 py-1 rounded-full border-2 transition duration-150 hover:bg-blue-900",onClick:t},[x(s,{icon:"fa-solid fa-play"}),xe]),g("button",{class:"px-5 py-1 rounded-full border-2 transition duration-150 hover:bg-blue-900",onClick:y},[x(s,{icon:"fa-brands fa-python"}),Re]),g("button",Ie,[x(s,{icon:"fa-solid fa-circle-question"}),Be])])])])}}};var Le=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Se(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}var Lt={exports:{}};(function(b,m){(function(i,y){b.exports=y()})(typeof self<"u"?self:Le,function(){return function(i){var y={};function w(v){if(y[v])return y[v].exports;var h=y[v]={i:v,l:!1,exports:{}};return i[v].call(h.exports,h,h.exports,w),h.l=!0,h.exports}return w.m=i,w.c=y,w.d=function(v,h,t){w.o(v,h)||Object.defineProperty(v,h,{enumerable:!0,get:t})},w.r=function(v){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(v,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(v,"__esModule",{value:!0})},w.t=function(v,h){if(1&h&&(v=w(v)),8&h||4&h&&typeof v=="object"&&v&&v.__esModule)return v;var t=Object.create(null);if(w.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:v}),2&h&&typeof v!="string")for(var e in v)w.d(t,e,function(n){return v[n]}.bind(null,e));return t},w.n=function(v){var h=v&&v.__esModule?function(){return v.default}:function(){return v};return w.d(h,"a",h),h},w.o=function(v,h){return Object.prototype.hasOwnProperty.call(v,h)},w.p="",w(w.s=0)}([function(i,y,w){w.r(y),w.d(y,"default",function(){return v});class v{constructor(t,e=null,n=null){this.events={},this.container=t,this.precanvas=null,this.nodeId=1,this.ele_selected=null,this.node_selected=null,this.drag=!1,this.reroute=!1,this.reroute_fix_curvature=!1,this.curvature=.5,this.reroute_curvature_start_end=.5,this.reroute_curvature=.5,this.reroute_width=6,this.drag_point=!1,this.editor_selected=!1,this.connection=!1,this.connection_ele=null,this.connection_selected=null,this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_x_start=0,this.pos_y=0,this.pos_y_start=0,this.mouse_x=0,this.mouse_y=0,this.line_path=5,this.first_click=null,this.force_first_input=!1,this.draggable_inputs=!0,this.useuuid=!1,this.parent=n,this.noderegister={},this.render=e,this.drawflow={drawflow:{Home:{data:{}}}},this.module="Home",this.editor_mode="edit",this.zoom=1,this.zoom_max=1.6,this.zoom_min=.5,this.zoom_value=.1,this.zoom_last_value=1,this.evCache=new Array,this.prevDiff=-1}start(){this.container.classList.add("parent-drawflow"),this.container.tabIndex=0,this.precanvas=document.createElement("div"),this.precanvas.classList.add("drawflow"),this.container.appendChild(this.precanvas),this.container.addEventListener("mouseup",this.dragEnd.bind(this)),this.container.addEventListener("mousemove",this.position.bind(this)),this.container.addEventListener("mousedown",this.click.bind(this)),this.container.addEventListener("touchend",this.dragEnd.bind(this)),this.container.addEventListener("touchmove",this.position.bind(this)),this.container.addEventListener("touchstart",this.click.bind(this)),this.container.addEventListener("contextmenu",this.contextmenu.bind(this)),this.container.addEventListener("keydown",this.key.bind(this)),this.container.addEventListener("wheel",this.zoom_enter.bind(this)),this.container.addEventListener("input",this.updateNodeValue.bind(this)),this.container.addEventListener("dblclick",this.dblclick.bind(this)),this.container.onpointerdown=this.pointerdown_handler.bind(this),this.container.onpointermove=this.pointermove_handler.bind(this),this.container.onpointerup=this.pointerup_handler.bind(this),this.container.onpointercancel=this.pointerup_handler.bind(this),this.container.onpointerout=this.pointerup_handler.bind(this),this.container.onpointerleave=this.pointerup_handler.bind(this),this.load()}pointerdown_handler(t){this.evCache.push(t)}pointermove_handler(t){for(var e=0;e<this.evCache.length;e++)if(t.pointerId==this.evCache[e].pointerId){this.evCache[e]=t;break}if(this.evCache.length==2){var n=Math.abs(this.evCache[0].clientX-this.evCache[1].clientX);this.prevDiff>100&&(n>this.prevDiff&&this.zoom_in(),n<this.prevDiff&&this.zoom_out()),this.prevDiff=n}}pointerup_handler(t){this.remove_event(t),this.evCache.length<2&&(this.prevDiff=-1)}remove_event(t){for(var e=0;e<this.evCache.length;e++)if(this.evCache[e].pointerId==t.pointerId){this.evCache.splice(e,1);break}}load(){for(var t in this.drawflow.drawflow[this.module].data)this.addNodeImport(this.drawflow.drawflow[this.module].data[t],this.precanvas);if(this.reroute)for(var t in this.drawflow.drawflow[this.module].data)this.addRerouteImport(this.drawflow.drawflow[this.module].data[t]);for(var t in this.drawflow.drawflow[this.module].data)this.updateConnectionNodes("node-"+t);const e=this.drawflow.drawflow;let n=1;Object.keys(e).map(function(s,o){Object.keys(e[s].data).map(function(l,r){parseInt(l)>=n&&(n=parseInt(l)+1)})}),this.nodeId=n}removeReouteConnectionSelected(){this.dispatch("connectionUnselected",!0),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((t,e)=>{t.classList.remove("selected")})}click(t){if(this.dispatch("click",t),this.editor_mode==="fixed"){if(t.preventDefault(),t.target.classList[0]!=="parent-drawflow"&&t.target.classList[0]!=="drawflow")return!1;this.ele_selected=t.target.closest(".parent-drawflow")}else this.editor_mode==="view"?(t.target.closest(".drawflow")!=null||t.target.matches(".parent-drawflow"))&&(this.ele_selected=t.target.closest(".parent-drawflow"),t.preventDefault()):(this.first_click=t.target,this.ele_selected=t.target,t.button===0&&this.contextmenuDel(),t.target.closest(".drawflow_content_node")!=null&&(this.ele_selected=t.target.closest(".drawflow_content_node").parentElement));switch(this.ele_selected.classList[0]){case"drawflow-node":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected!=this.ele_selected&&this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.node_selected!=this.ele_selected&&this.dispatch("nodeSelected",this.ele_selected.id.slice(5)),this.node_selected=this.ele_selected,this.node_selected.classList.add("selected"),this.draggable_inputs?t.target.tagName!=="SELECT"&&(this.drag=!0):t.target.tagName!=="INPUT"&&t.target.tagName!=="TEXTAREA"&&t.target.tagName!=="SELECT"&&t.target.hasAttribute("contenteditable")!==!0&&(this.drag=!0);break;case"output":this.connection=!0,this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.drawConnection(t.target);break;case"parent-drawflow":case"drawflow":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.editor_selected=!0;break;case"main-path":this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.connection_selected=this.ele_selected,this.connection_selected.classList.add("selected");const e=this.connection_selected.parentElement.classList;e.length>1&&(this.dispatch("connectionSelected",{output_id:e[2].slice(14),input_id:e[1].slice(13),output_class:e[3],input_class:e[4]}),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((n,s)=>{n.classList.add("selected")}));break;case"point":this.drag_point=!0,this.ele_selected.classList.add("selected");break;case"drawflow-delete":this.node_selected&&this.removeNodeId(this.node_selected.id),this.connection_selected&&this.removeConnection(),this.node_selected!=null&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),this.connection_selected!=null&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null)}t.type==="touchstart"?(this.pos_x=t.touches[0].clientX,this.pos_x_start=t.touches[0].clientX,this.pos_y=t.touches[0].clientY,this.pos_y_start=t.touches[0].clientY,this.mouse_x=t.touches[0].clientX,this.mouse_y=t.touches[0].clientY):(this.pos_x=t.clientX,this.pos_x_start=t.clientX,this.pos_y=t.clientY,this.pos_y_start=t.clientY),["input","output","main-path"].includes(this.ele_selected.classList[0])&&t.preventDefault(),this.dispatch("clickEnd",t)}position(t){if(t.type==="touchmove")var e=t.touches[0].clientX,n=t.touches[0].clientY;else e=t.clientX,n=t.clientY;if(this.connection&&this.updateConnection(e,n),this.editor_selected&&(s=this.canvas_x+-(this.pos_x-e),o=this.canvas_y+-(this.pos_y-n),this.dispatch("translate",{x:s,y:o}),this.precanvas.style.transform="translate("+s+"px, "+o+"px) scale("+this.zoom+")"),this.drag){t.preventDefault();var s=(this.pos_x-e)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),o=(this.pos_y-n)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom);this.pos_x=e,this.pos_y=n,this.ele_selected.style.top=this.ele_selected.offsetTop-o+"px",this.ele_selected.style.left=this.ele_selected.offsetLeft-s+"px",this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_x=this.ele_selected.offsetLeft-s,this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_y=this.ele_selected.offsetTop-o,this.updateConnectionNodes(this.ele_selected.id)}if(this.drag_point){s=(this.pos_x-e)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),o=(this.pos_y-n)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom),this.pos_x=e,this.pos_y=n;var l=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),r=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));this.ele_selected.setAttributeNS(null,"cx",l),this.ele_selected.setAttributeNS(null,"cy",r);const p=this.ele_selected.parentElement.classList[2].slice(9),d=this.ele_selected.parentElement.classList[1].slice(13),a=this.ele_selected.parentElement.classList[3],c=this.ele_selected.parentElement.classList[4];let u=Array.from(this.ele_selected.parentElement.children).indexOf(this.ele_selected)-1;this.reroute_fix_curvature&&(u-=this.ele_selected.parentElement.querySelectorAll(".main-path").length-1,u<0&&(u=0));const f=p.slice(5),_=this.drawflow.drawflow[this.module].data[f].outputs[a].connections.findIndex(function(R,I){return R.node===d&&R.output===c});this.drawflow.drawflow[this.module].data[f].outputs[a].connections[_].points[u]={pos_x:l,pos_y:r};const C=this.ele_selected.parentElement.classList[2].slice(9);this.updateConnectionNodes(C)}t.type==="touchmove"&&(this.mouse_x=e,this.mouse_y=n),this.dispatch("mouseMove",{x:e,y:n})}dragEnd(t){if(t.type==="touchend")var e=this.mouse_x,n=this.mouse_y,s=document.elementFromPoint(e,n);else e=t.clientX,n=t.clientY,s=t.target;if(this.drag&&(this.pos_x_start==e&&this.pos_y_start==n||this.dispatch("nodeMoved",this.ele_selected.id.slice(5))),this.drag_point&&(this.ele_selected.classList.remove("selected"),this.pos_x_start==e&&this.pos_y_start==n||this.dispatch("rerouteMoved",this.ele_selected.parentElement.classList[2].slice(14))),this.editor_selected&&(this.canvas_x=this.canvas_x+-(this.pos_x-e),this.canvas_y=this.canvas_y+-(this.pos_y-n),this.editor_selected=!1),this.connection===!0)if(s.classList[0]==="input"||this.force_first_input&&(s.closest(".drawflow_content_node")!=null||s.classList[0]==="drawflow-node")){if(!this.force_first_input||s.closest(".drawflow_content_node")==null&&s.classList[0]!=="drawflow-node")o=s.parentElement.parentElement.id,l=s.classList[1];else{if(s.closest(".drawflow_content_node")!=null)var o=s.closest(".drawflow_content_node").parentElement.id;else var o=s.id;if(Object.keys(this.getNodeFromId(o.slice(5)).inputs).length===0)var l=!1;else var l="input_1"}var r=this.ele_selected.parentElement.parentElement.id,p=this.ele_selected.classList[1];if(r!==o&&l!==!1){if(this.container.querySelectorAll(".connection.node_in_"+o+".node_out_"+r+"."+p+"."+l).length===0){this.connection_ele.classList.add("node_in_"+o),this.connection_ele.classList.add("node_out_"+r),this.connection_ele.classList.add(p),this.connection_ele.classList.add(l);var d=o.slice(5),a=r.slice(5);this.drawflow.drawflow[this.module].data[a].outputs[p].connections.push({node:d,output:l}),this.drawflow.drawflow[this.module].data[d].inputs[l].connections.push({node:a,input:p}),this.updateConnectionNodes("node-"+a),this.updateConnectionNodes("node-"+d),this.dispatch("connectionCreated",{output_id:a,input_id:d,output_class:p,input_class:l})}else this.dispatch("connectionCancel",!0),this.connection_ele.remove();this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null;this.drag=!1,this.drag_point=!1,this.connection=!1,this.ele_selected=null,this.editor_selected=!1,this.dispatch("mouseUp",t)}contextmenu(t){if(this.dispatch("contextmenu",t),t.preventDefault(),this.editor_mode==="fixed"||this.editor_mode==="view")return!1;if(this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove(),this.node_selected||this.connection_selected){var e=document.createElement("div");e.classList.add("drawflow-delete"),e.innerHTML="x",this.node_selected&&this.node_selected.appendChild(e),this.connection_selected&&this.connection_selected.parentElement.classList.length>1&&(e.style.top=t.clientY*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))+"px",e.style.left=t.clientX*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))+"px",this.precanvas.appendChild(e))}}contextmenuDel(){this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove()}key(t){if(this.dispatch("keydown",t),this.editor_mode==="fixed"||this.editor_mode==="view")return!1;(t.key==="Delete"||t.key==="Backspace"&&t.metaKey)&&(this.node_selected!=null&&this.first_click.tagName!=="INPUT"&&this.first_click.tagName!=="TEXTAREA"&&this.first_click.hasAttribute("contenteditable")!==!0&&this.removeNodeId(this.node_selected.id),this.connection_selected!=null&&this.removeConnection())}zoom_enter(t,e){t.ctrlKey&&(t.preventDefault(),t.deltaY>0?this.zoom_out():this.zoom_in())}zoom_refresh(){this.dispatch("zoom",this.zoom),this.canvas_x=this.canvas_x/this.zoom_last_value*this.zoom,this.canvas_y=this.canvas_y/this.zoom_last_value*this.zoom,this.zoom_last_value=this.zoom,this.precanvas.style.transform="translate("+this.canvas_x+"px, "+this.canvas_y+"px) scale("+this.zoom+")"}zoom_in(){this.zoom<this.zoom_max&&(this.zoom+=this.zoom_value,this.zoom_refresh())}zoom_out(){this.zoom>this.zoom_min&&(this.zoom-=this.zoom_value,this.zoom_refresh())}zoom_reset(){this.zoom!=1&&(this.zoom=1,this.zoom_refresh())}createCurvature(t,e,n,s,o,l){var r=t,p=e,d=n,a=s,c=o;switch(l){case"open":if(t>=n)var u=r+Math.abs(d-r)*c,f=d-Math.abs(d-r)*(-1*c);else u=r+Math.abs(d-r)*c,f=d-Math.abs(d-r)*c;return" M "+r+" "+p+" C "+u+" "+p+" "+f+" "+a+" "+d+"  "+a;case"close":return t>=n?(u=r+Math.abs(d-r)*(-1*c),f=d-Math.abs(d-r)*c):(u=r+Math.abs(d-r)*c,f=d-Math.abs(d-r)*c)," M "+r+" "+p+" C "+u+" "+p+" "+f+" "+a+" "+d+"  "+a;case"other":return t>=n?(u=r+Math.abs(d-r)*(-1*c),f=d-Math.abs(d-r)*(-1*c)):(u=r+Math.abs(d-r)*c,f=d-Math.abs(d-r)*c)," M "+r+" "+p+" C "+u+" "+p+" "+f+" "+a+" "+d+"  "+a;default:return" M "+r+" "+p+" C "+(u=r+Math.abs(d-r)*c)+" "+p+" "+(f=d-Math.abs(d-r)*c)+" "+a+" "+d+"  "+a}}drawConnection(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");this.connection_ele=e;var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.classList.add("main-path"),n.setAttributeNS(null,"d",""),e.classList.add("connection"),e.appendChild(n),this.precanvas.appendChild(e);var s=t.parentElement.parentElement.id.slice(5),o=t.classList[1];this.dispatch("connectionStart",{output_id:s,output_class:o})}updateConnection(t,e){const n=this.precanvas,s=this.zoom;let o=n.clientWidth/(n.clientWidth*s);o=o||0;let l=n.clientHeight/(n.clientHeight*s);l=l||0;var r=this.connection_ele.children[0],p=this.ele_selected.offsetWidth/2+(this.ele_selected.getBoundingClientRect().x-n.getBoundingClientRect().x)*o,d=this.ele_selected.offsetHeight/2+(this.ele_selected.getBoundingClientRect().y-n.getBoundingClientRect().y)*l,a=t*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),c=e*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom)),u=this.curvature,f=this.createCurvature(p,d,a,c,u,"openclose");r.setAttributeNS(null,"d",f)}addConnection(t,e,n,s){var o=this.getModuleFromNodeId(t);if(o===this.getModuleFromNodeId(e)){var l=this.getNodeFromId(t),r=!1;for(var p in l.outputs[n].connections){var d=l.outputs[n].connections[p];d.node==e&&d.output==s&&(r=!0)}if(r===!1){if(this.drawflow.drawflow[o].data[t].outputs[n].connections.push({node:e.toString(),output:s}),this.drawflow.drawflow[o].data[e].inputs[s].connections.push({node:t.toString(),input:n}),this.module===o){var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=document.createElementNS("http://www.w3.org/2000/svg","path");c.classList.add("main-path"),c.setAttributeNS(null,"d",""),a.classList.add("connection"),a.classList.add("node_in_node-"+e),a.classList.add("node_out_node-"+t),a.classList.add(n),a.classList.add(s),a.appendChild(c),this.precanvas.appendChild(a),this.updateConnectionNodes("node-"+t),this.updateConnectionNodes("node-"+e)}this.dispatch("connectionCreated",{output_id:t,input_id:e,output_class:n,input_class:s})}}}updateConnectionNodes(t){const e="node_in_"+t,n="node_out_"+t;this.line_path;const s=this.container,o=this.precanvas,l=this.curvature,r=this.createCurvature,p=this.reroute_curvature,d=this.reroute_curvature_start_end,a=this.reroute_fix_curvature,c=this.reroute_width,u=this.zoom;let f=o.clientWidth/(o.clientWidth*u);f=f||0;let _=o.clientHeight/(o.clientHeight*u);_=_||0;const C=s.querySelectorAll("."+n);Object.keys(C).map(function(I,F){if(C[I].querySelector(".point")===null){var V=s.querySelector("#"+t),N=C[I].classList[1].replace("node_in_",""),Y=s.querySelector("#"+N).querySelectorAll("."+C[I].classList[4])[0],et=Y.offsetWidth/2+(Y.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,Q=Y.offsetHeight/2+(Y.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,nt=V.querySelectorAll("."+C[I].classList[3])[0],K=nt.offsetWidth/2+(nt.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,J=nt.offsetHeight/2+(nt.getBoundingClientRect().y-o.getBoundingClientRect().y)*_;const q=r(K,J,et,Q,l,"openclose");C[I].children[0].setAttributeNS(null,"d",q)}else{const q=C[I].querySelectorAll(".point");let k="";const E=[];q.forEach((L,B)=>{if(B===0&&q.length-1==0){var z=s.querySelector("#"+t),A=((O=L).getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,M=(O.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,H=(j=z.querySelectorAll("."+L.parentElement.classList[3])[0]).offsetWidth/2+(j.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,S=j.offsetHeight/2+(j.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,$=r(H,S,A,M,d,"open");k+=$,E.push($),z=L;var Z=L.parentElement.classList[1].replace("node_in_",""),O=(T=s.querySelector("#"+Z)).querySelectorAll("."+L.parentElement.classList[4])[0];A=(ot=T.querySelectorAll("."+L.parentElement.classList[4])[0]).offsetWidth/2+(ot.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,M=ot.offsetHeight/2+(ot.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,H=(z.getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,S=(z.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,$=r(H,S,A,M,d,"close"),k+=$,E.push($)}else if(B===0){var j;z=s.querySelector("#"+t),A=((O=L).getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,M=(O.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,H=(j=z.querySelectorAll("."+L.parentElement.classList[3])[0]).offsetWidth/2+(j.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,S=j.offsetHeight/2+(j.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,$=r(H,S,A,M,d,"open"),k+=$,E.push($),z=L,A=((O=q[B+1]).getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,M=(O.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,H=(z.getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,S=(z.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,$=r(H,S,A,M,p,"other"),k+=$,E.push($)}else if(B===q.length-1){var T,ot;z=L,Z=L.parentElement.classList[1].replace("node_in_",""),O=(T=s.querySelector("#"+Z)).querySelectorAll("."+L.parentElement.classList[4])[0],A=(ot=T.querySelectorAll("."+L.parentElement.classList[4])[0]).offsetWidth/2+(ot.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,M=ot.offsetHeight/2+(ot.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,H=(z.getBoundingClientRect().x-o.getBoundingClientRect().x)*(o.clientWidth/(o.clientWidth*u))+c,S=(z.getBoundingClientRect().y-o.getBoundingClientRect().y)*(o.clientHeight/(o.clientHeight*u))+c,$=r(H,S,A,M,d,"close"),k+=$,E.push($)}else z=L,A=((O=q[B+1]).getBoundingClientRect().x-o.getBoundingClientRect().x)*(o.clientWidth/(o.clientWidth*u))+c,M=(O.getBoundingClientRect().y-o.getBoundingClientRect().y)*(o.clientHeight/(o.clientHeight*u))+c,H=(z.getBoundingClientRect().x-o.getBoundingClientRect().x)*(o.clientWidth/(o.clientWidth*u))+c,S=(z.getBoundingClientRect().y-o.getBoundingClientRect().y)*(o.clientHeight/(o.clientHeight*u))+c,$=r(H,S,A,M,p,"other"),k+=$,E.push($)}),a?E.forEach((L,B)=>{C[I].children[B].setAttributeNS(null,"d",L)}):C[I].children[0].setAttributeNS(null,"d",k)}});const R=s.querySelectorAll("."+e);Object.keys(R).map(function(I,F){if(R[I].querySelector(".point")===null){var V=s.querySelector("#"+t),N=R[I].classList[2].replace("node_out_",""),Y=s.querySelector("#"+N).querySelectorAll("."+R[I].classList[3])[0],et=Y.offsetWidth/2+(Y.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,Q=Y.offsetHeight/2+(Y.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,nt=(V=V.querySelectorAll("."+R[I].classList[4])[0]).offsetWidth/2+(V.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,K=V.offsetHeight/2+(V.getBoundingClientRect().y-o.getBoundingClientRect().y)*_;const J=r(et,Q,nt,K,l,"openclose");R[I].children[0].setAttributeNS(null,"d",J)}else{const J=R[I].querySelectorAll(".point");let q="";const k=[];J.forEach((E,L)=>{if(L===0&&J.length-1==0){var B=s.querySelector("#"+t),z=((Z=E).getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,A=(Z.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,M=(T=B.querySelectorAll("."+E.parentElement.classList[4])[0]).offsetWidth/2+(T.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,H=T.offsetHeight/2+(T.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,S=r(z,A,M,H,d,"close");q+=S,k.push(S),B=E;var $=E.parentElement.classList[2].replace("node_out_",""),Z=(j=s.querySelector("#"+$)).querySelectorAll("."+E.parentElement.classList[3])[0];z=(O=j.querySelectorAll("."+E.parentElement.classList[3])[0]).offsetWidth/2+(O.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,A=O.offsetHeight/2+(O.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,M=(B.getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,H=(B.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,S=r(z,A,M,H,d,"open"),q+=S,k.push(S)}else if(L===0){var O;B=E,$=E.parentElement.classList[2].replace("node_out_",""),Z=(j=s.querySelector("#"+$)).querySelectorAll("."+E.parentElement.classList[3])[0],z=(O=j.querySelectorAll("."+E.parentElement.classList[3])[0]).offsetWidth/2+(O.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,A=O.offsetHeight/2+(O.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,M=(B.getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,H=(B.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,S=r(z,A,M,H,d,"open"),q+=S,k.push(S),B=E,M=((Z=J[L+1]).getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,H=(Z.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,z=(B.getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,A=(B.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,S=r(z,A,M,H,p,"other"),q+=S,k.push(S)}else if(L===J.length-1){var j,T;B=E,$=E.parentElement.classList[1].replace("node_in_",""),Z=(j=s.querySelector("#"+$)).querySelectorAll("."+E.parentElement.classList[4])[0],M=(T=j.querySelectorAll("."+E.parentElement.classList[4])[0]).offsetWidth/2+(T.getBoundingClientRect().x-o.getBoundingClientRect().x)*f,H=T.offsetHeight/2+(T.getBoundingClientRect().y-o.getBoundingClientRect().y)*_,z=(B.getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,A=(B.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,S=r(z,A,M,H,d,"close"),q+=S,k.push(S)}else B=E,M=((Z=J[L+1]).getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,H=(Z.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,z=(B.getBoundingClientRect().x-o.getBoundingClientRect().x)*f+c,A=(B.getBoundingClientRect().y-o.getBoundingClientRect().y)*_+c,S=r(z,A,M,H,p,"other"),q+=S,k.push(S)}),a?k.forEach((E,L)=>{R[I].children[L].setAttributeNS(null,"d",E)}):R[I].children[0].setAttributeNS(null,"d",q)}})}dblclick(t){this.connection_selected!=null&&this.reroute&&this.createReroutePoint(this.connection_selected),t.target.classList[0]==="point"&&this.removeReroutePoint(t.target)}createReroutePoint(t){this.connection_selected.classList.remove("selected");const e=this.connection_selected.parentElement.classList[2].slice(9),n=this.connection_selected.parentElement.classList[1].slice(13),s=this.connection_selected.parentElement.classList[3],o=this.connection_selected.parentElement.classList[4];this.connection_selected=null;const l=document.createElementNS("http://www.w3.org/2000/svg","circle");l.classList.add("point");var r=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),p=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));l.setAttributeNS(null,"cx",r),l.setAttributeNS(null,"cy",p),l.setAttributeNS(null,"r",this.reroute_width);let d=0;if(this.reroute_fix_curvature){const f=t.parentElement.querySelectorAll(".main-path").length;var a=document.createElementNS("http://www.w3.org/2000/svg","path");if(a.classList.add("main-path"),a.setAttributeNS(null,"d",""),t.parentElement.insertBefore(a,t.parentElement.children[f]),f===1)t.parentElement.appendChild(l);else{const _=Array.from(t.parentElement.children).indexOf(t);d=_,t.parentElement.insertBefore(l,t.parentElement.children[_+f+1])}}else t.parentElement.appendChild(l);const c=e.slice(5),u=this.drawflow.drawflow[this.module].data[c].outputs[s].connections.findIndex(function(f,_){return f.node===n&&f.output===o});this.drawflow.drawflow[this.module].data[c].outputs[s].connections[u].points===void 0&&(this.drawflow.drawflow[this.module].data[c].outputs[s].connections[u].points=[]),this.reroute_fix_curvature?(d>0||this.drawflow.drawflow[this.module].data[c].outputs[s].connections[u].points!==[]?this.drawflow.drawflow[this.module].data[c].outputs[s].connections[u].points.splice(d,0,{pos_x:r,pos_y:p}):this.drawflow.drawflow[this.module].data[c].outputs[s].connections[u].points.push({pos_x:r,pos_y:p}),t.parentElement.querySelectorAll(".main-path").forEach((f,_)=>{f.classList.remove("selected")})):this.drawflow.drawflow[this.module].data[c].outputs[s].connections[u].points.push({pos_x:r,pos_y:p}),this.dispatch("addReroute",c),this.updateConnectionNodes(e)}removeReroutePoint(t){const e=t.parentElement.classList[2].slice(9),n=t.parentElement.classList[1].slice(13),s=t.parentElement.classList[3],o=t.parentElement.classList[4];let l=Array.from(t.parentElement.children).indexOf(t);const r=e.slice(5),p=this.drawflow.drawflow[this.module].data[r].outputs[s].connections.findIndex(function(d,a){return d.node===n&&d.output===o});if(this.reroute_fix_curvature){const d=t.parentElement.querySelectorAll(".main-path").length;t.parentElement.children[d-1].remove(),l-=d,l<0&&(l=0)}else l--;this.drawflow.drawflow[this.module].data[r].outputs[s].connections[p].points.splice(l,1),t.remove(),this.dispatch("removeReroute",r),this.updateConnectionNodes(e)}registerNode(t,e,n=null,s=null){this.noderegister[t]={html:e,props:n,options:s}}getNodeFromId(t){var e=this.getModuleFromNodeId(t);return JSON.parse(JSON.stringify(this.drawflow.drawflow[e].data[t]))}getNodesFromName(t){var e=[];const n=this.drawflow.drawflow;return Object.keys(n).map(function(s,o){for(var l in n[s].data)n[s].data[l].name==t&&e.push(n[s].data[l].id)}),e}addNode(t,e,n,s,o,l,r,p,d=!1){if(this.useuuid)var a=this.getUuid();else a=this.nodeId;const c=document.createElement("div");c.classList.add("parent-node");const u=document.createElement("div");u.innerHTML="",u.setAttribute("id","node-"+a),u.classList.add("drawflow-node"),l!=""&&u.classList.add(...l.split(" "));const f=document.createElement("div");f.classList.add("inputs");const _=document.createElement("div");_.classList.add("outputs");const C={};for(var R=0;R<e;R++){const N=document.createElement("div");N.classList.add("input"),N.classList.add("input_"+(R+1)),C["input_"+(R+1)]={connections:[]},f.appendChild(N)}const I={};for(R=0;R<n;R++){const N=document.createElement("div");N.classList.add("output"),N.classList.add("output_"+(R+1)),I["output_"+(R+1)]={connections:[]},_.appendChild(N)}const F=document.createElement("div");if(F.classList.add("drawflow_content_node"),d===!1)F.innerHTML=p;else if(d===!0)F.appendChild(this.noderegister[p].html.cloneNode(!0));else if(parseInt(this.render.version)===3){let N=this.render.h(this.noderegister[p].html,this.noderegister[p].props,this.noderegister[p].options);N.appContext=this.parent,this.render.render(N,F)}else{let N=new this.render({parent:this.parent,render:Y=>Y(this.noderegister[p].html,{props:this.noderegister[p].props}),...this.noderegister[p].options}).$mount();F.appendChild(N.$el)}Object.entries(r).forEach(function(N,Y){if(typeof N[1]=="object")(function nt(K,J,q){K===null?K=r[J]:K=K[J],K!==null&&Object.entries(K).forEach(function(k,E){if(typeof k[1]=="object")nt(K,k[0],q+"-"+k[0]);else for(var L=F.querySelectorAll("[df-"+q+"-"+k[0]+"]"),B=0;B<L.length;B++)L[B].value=k[1],L[B].isContentEditable&&(L[B].innerText=k[1])})})(null,N[0],N[0]);else for(var et=F.querySelectorAll("[df-"+N[0]+"]"),Q=0;Q<et.length;Q++)et[Q].value=N[1],et[Q].isContentEditable&&(et[Q].innerText=N[1])}),u.appendChild(f),u.appendChild(F),u.appendChild(_),u.style.top=o+"px",u.style.left=s+"px",c.appendChild(u),this.precanvas.appendChild(c);var V={id:a,name:t,data:r,class:l,html:p,typenode:d,inputs:C,outputs:I,pos_x:s,pos_y:o};return this.drawflow.drawflow[this.module].data[a]=V,this.dispatch("nodeCreated",a),this.useuuid||this.nodeId++,a}addNodeImport(t,e){const n=document.createElement("div");n.classList.add("parent-node");const s=document.createElement("div");s.innerHTML="",s.setAttribute("id","node-"+t.id),s.classList.add("drawflow-node"),t.class!=""&&s.classList.add(...t.class.split(" "));const o=document.createElement("div");o.classList.add("inputs");const l=document.createElement("div");l.classList.add("outputs"),Object.keys(t.inputs).map(function(d,a){const c=document.createElement("div");c.classList.add("input"),c.classList.add(d),o.appendChild(c),Object.keys(t.inputs[d].connections).map(function(u,f){var _=document.createElementNS("http://www.w3.org/2000/svg","svg"),C=document.createElementNS("http://www.w3.org/2000/svg","path");C.classList.add("main-path"),C.setAttributeNS(null,"d",""),_.classList.add("connection"),_.classList.add("node_in_node-"+t.id),_.classList.add("node_out_node-"+t.inputs[d].connections[u].node),_.classList.add(t.inputs[d].connections[u].input),_.classList.add(d),_.appendChild(C),e.appendChild(_)})});for(var r=0;r<Object.keys(t.outputs).length;r++){const d=document.createElement("div");d.classList.add("output"),d.classList.add("output_"+(r+1)),l.appendChild(d)}const p=document.createElement("div");if(p.classList.add("drawflow_content_node"),t.typenode===!1)p.innerHTML=t.html;else if(t.typenode===!0)p.appendChild(this.noderegister[t.html].html.cloneNode(!0));else if(parseInt(this.render.version)===3){let d=this.render.h(this.noderegister[t.html].html,this.noderegister[t.html].props,this.noderegister[t.html].options);d.appContext=this.parent,this.render.render(d,p)}else{let d=new this.render({parent:this.parent,render:a=>a(this.noderegister[t.html].html,{props:this.noderegister[t.html].props}),...this.noderegister[t.html].options}).$mount();p.appendChild(d.$el)}Object.entries(t.data).forEach(function(d,a){if(typeof d[1]=="object")(function f(_,C,R){_===null?_=t.data[C]:_=_[C],_!==null&&Object.entries(_).forEach(function(I,F){if(typeof I[1]=="object")f(_,I[0],R+"-"+I[0]);else for(var V=p.querySelectorAll("[df-"+R+"-"+I[0]+"]"),N=0;N<V.length;N++)V[N].value=I[1],V[N].isContentEditable&&(V[N].innerText=I[1])})})(null,d[0],d[0]);else for(var c=p.querySelectorAll("[df-"+d[0]+"]"),u=0;u<c.length;u++)c[u].value=d[1],c[u].isContentEditable&&(c[u].innerText=d[1])}),s.appendChild(o),s.appendChild(p),s.appendChild(l),s.style.top=t.pos_y+"px",s.style.left=t.pos_x+"px",n.appendChild(s),this.precanvas.appendChild(n)}addRerouteImport(t){const e=this.reroute_width,n=this.reroute_fix_curvature,s=this.container;Object.keys(t.outputs).map(function(o,l){Object.keys(t.outputs[o].connections).map(function(r,p){const d=t.outputs[o].connections[r].points;d!==void 0&&d.forEach((a,c)=>{const u=t.outputs[o].connections[r].node,f=t.outputs[o].connections[r].output,_=s.querySelector(".connection.node_in_node-"+u+".node_out_node-"+t.id+"."+o+"."+f);if(n&&c===0)for(var C=0;C<d.length;C++){var R=document.createElementNS("http://www.w3.org/2000/svg","path");R.classList.add("main-path"),R.setAttributeNS(null,"d",""),_.appendChild(R)}const I=document.createElementNS("http://www.w3.org/2000/svg","circle");I.classList.add("point");var F=a.pos_x,V=a.pos_y;I.setAttributeNS(null,"cx",F),I.setAttributeNS(null,"cy",V),I.setAttributeNS(null,"r",e),_.appendChild(I)})})})}updateNodeValue(t){for(var e=t.target.attributes,n=0;n<e.length;n++)if(e[n].nodeName.startsWith("df-")){for(var s=e[n].nodeName.slice(3).split("-"),o=this.drawflow.drawflow[this.module].data[t.target.closest(".drawflow_content_node").parentElement.id.slice(5)].data,l=0;l<s.length-1;l+=1)o[s[l]]==null&&(o[s[l]]={}),o=o[s[l]];o[s[s.length-1]]=t.target.value,t.target.isContentEditable&&(o[s[s.length-1]]=t.target.innerText),this.dispatch("nodeDataChanged",t.target.closest(".drawflow_content_node").parentElement.id.slice(5))}}updateNodeDataFromId(t,e){var n=this.getModuleFromNodeId(t);if(this.drawflow.drawflow[n].data[t].data=e,this.module===n){const s=this.container.querySelector("#node-"+t);Object.entries(e).forEach(function(o,l){if(typeof o[1]=="object")(function d(a,c,u){a===null?a=e[c]:a=a[c],a!==null&&Object.entries(a).forEach(function(f,_){if(typeof f[1]=="object")d(a,f[0],u+"-"+f[0]);else for(var C=s.querySelectorAll("[df-"+u+"-"+f[0]+"]"),R=0;R<C.length;R++)C[R].value=f[1],C[R].isContentEditable&&(C[R].innerText=f[1])})})(null,o[0],o[0]);else for(var r=s.querySelectorAll("[df-"+o[0]+"]"),p=0;p<r.length;p++)r[p].value=o[1],r[p].isContentEditable&&(r[p].innerText=o[1])})}}addNodeInput(t){var e=this.getModuleFromNodeId(t);const n=this.getNodeFromId(t),s=Object.keys(n.inputs).length;if(this.module===e){const o=document.createElement("div");o.classList.add("input"),o.classList.add("input_"+(s+1)),this.container.querySelector("#node-"+t+" .inputs").appendChild(o),this.updateConnectionNodes("node-"+t)}this.drawflow.drawflow[e].data[t].inputs["input_"+(s+1)]={connections:[]}}addNodeOutput(t){var e=this.getModuleFromNodeId(t);const n=this.getNodeFromId(t),s=Object.keys(n.outputs).length;if(this.module===e){const o=document.createElement("div");o.classList.add("output"),o.classList.add("output_"+(s+1)),this.container.querySelector("#node-"+t+" .outputs").appendChild(o),this.updateConnectionNodes("node-"+t)}this.drawflow.drawflow[e].data[t].outputs["output_"+(s+1)]={connections:[]}}removeNodeInput(t,e){var n=this.getModuleFromNodeId(t);const s=this.getNodeFromId(t);this.module===n&&this.container.querySelector("#node-"+t+" .inputs .input."+e).remove();const o=[];Object.keys(s.inputs[e].connections).map(function(a,c){const u=s.inputs[e].connections[c].node,f=s.inputs[e].connections[c].input;o.push({id_output:u,id:t,output_class:f,input_class:e})}),o.forEach((a,c)=>{this.removeSingleConnection(a.id_output,a.id,a.output_class,a.input_class)}),delete this.drawflow.drawflow[n].data[t].inputs[e];const l=[],r=this.drawflow.drawflow[n].data[t].inputs;Object.keys(r).map(function(a,c){l.push(r[a])}),this.drawflow.drawflow[n].data[t].inputs={};const p=e.slice(6);let d=[];l.forEach((a,c)=>{a.connections.forEach((u,f)=>{d.push(u)}),this.drawflow.drawflow[n].data[t].inputs["input_"+(c+1)]=a}),d=new Set(d.map(a=>JSON.stringify(a))),d=Array.from(d).map(a=>JSON.parse(a)),this.module===n&&this.container.querySelectorAll("#node-"+t+" .inputs .input").forEach((a,c)=>{const u=a.classList[1].slice(6);parseInt(p)<parseInt(u)&&(a.classList.remove("input_"+u),a.classList.add("input_"+(u-1)))}),d.forEach((a,c)=>{this.drawflow.drawflow[n].data[a.node].outputs[a.input].connections.forEach((u,f)=>{if(u.node==t){const _=u.output.slice(6);if(parseInt(p)<parseInt(_)){if(this.module===n){const C=this.container.querySelector(".connection.node_in_node-"+t+".node_out_node-"+a.node+"."+a.input+".input_"+_);C.classList.remove("input_"+_),C.classList.add("input_"+(_-1))}u.points?this.drawflow.drawflow[n].data[a.node].outputs[a.input].connections[f]={node:u.node,output:"input_"+(_-1),points:u.points}:this.drawflow.drawflow[n].data[a.node].outputs[a.input].connections[f]={node:u.node,output:"input_"+(_-1)}}}})}),this.updateConnectionNodes("node-"+t)}removeNodeOutput(t,e){var n=this.getModuleFromNodeId(t);const s=this.getNodeFromId(t);this.module===n&&this.container.querySelector("#node-"+t+" .outputs .output."+e).remove();const o=[];Object.keys(s.outputs[e].connections).map(function(a,c){const u=s.outputs[e].connections[c].node,f=s.outputs[e].connections[c].output;o.push({id:t,id_input:u,output_class:e,input_class:f})}),o.forEach((a,c)=>{this.removeSingleConnection(a.id,a.id_input,a.output_class,a.input_class)}),delete this.drawflow.drawflow[n].data[t].outputs[e];const l=[],r=this.drawflow.drawflow[n].data[t].outputs;Object.keys(r).map(function(a,c){l.push(r[a])}),this.drawflow.drawflow[n].data[t].outputs={};const p=e.slice(7);let d=[];l.forEach((a,c)=>{a.connections.forEach((u,f)=>{d.push({node:u.node,output:u.output})}),this.drawflow.drawflow[n].data[t].outputs["output_"+(c+1)]=a}),d=new Set(d.map(a=>JSON.stringify(a))),d=Array.from(d).map(a=>JSON.parse(a)),this.module===n&&this.container.querySelectorAll("#node-"+t+" .outputs .output").forEach((a,c)=>{const u=a.classList[1].slice(7);parseInt(p)<parseInt(u)&&(a.classList.remove("output_"+u),a.classList.add("output_"+(u-1)))}),d.forEach((a,c)=>{this.drawflow.drawflow[n].data[a.node].inputs[a.output].connections.forEach((u,f)=>{if(u.node==t){const _=u.input.slice(7);if(parseInt(p)<parseInt(_)){if(this.module===n){const C=this.container.querySelector(".connection.node_in_node-"+a.node+".node_out_node-"+t+".output_"+_+"."+a.output);C.classList.remove("output_"+_),C.classList.remove(a.output),C.classList.add("output_"+(_-1)),C.classList.add(a.output)}u.points?this.drawflow.drawflow[n].data[a.node].inputs[a.output].connections[f]={node:u.node,input:"output_"+(_-1),points:u.points}:this.drawflow.drawflow[n].data[a.node].inputs[a.output].connections[f]={node:u.node,input:"output_"+(_-1)}}}})}),this.updateConnectionNodes("node-"+t)}removeNodeId(t){this.removeConnectionNodeId(t);var e=this.getModuleFromNodeId(t.slice(5));this.module===e&&this.container.querySelector("#"+t).remove(),delete this.drawflow.drawflow[e].data[t.slice(5)],this.dispatch("nodeRemoved",t.slice(5))}removeConnection(){if(this.connection_selected!=null){var t=this.connection_selected.parentElement.classList;this.connection_selected.parentElement.remove();var e=this.drawflow.drawflow[this.module].data[t[2].slice(14)].outputs[t[3]].connections.findIndex(function(s,o){return s.node===t[1].slice(13)&&s.output===t[4]});this.drawflow.drawflow[this.module].data[t[2].slice(14)].outputs[t[3]].connections.splice(e,1);var n=this.drawflow.drawflow[this.module].data[t[1].slice(13)].inputs[t[4]].connections.findIndex(function(s,o){return s.node===t[2].slice(14)&&s.input===t[3]});this.drawflow.drawflow[this.module].data[t[1].slice(13)].inputs[t[4]].connections.splice(n,1),this.dispatch("connectionRemoved",{output_id:t[2].slice(14),input_id:t[1].slice(13),output_class:t[3],input_class:t[4]}),this.connection_selected=null}}removeSingleConnection(t,e,n,s){var o=this.getModuleFromNodeId(t);if(o===this.getModuleFromNodeId(e)){if(this.drawflow.drawflow[o].data[t].outputs[n].connections.findIndex(function(p,d){return p.node==e&&p.output===s})>-1){this.module===o&&this.container.querySelector(".connection.node_in_node-"+e+".node_out_node-"+t+"."+n+"."+s).remove();var l=this.drawflow.drawflow[o].data[t].outputs[n].connections.findIndex(function(p,d){return p.node==e&&p.output===s});this.drawflow.drawflow[o].data[t].outputs[n].connections.splice(l,1);var r=this.drawflow.drawflow[o].data[e].inputs[s].connections.findIndex(function(p,d){return p.node==t&&p.input===n});return this.drawflow.drawflow[o].data[e].inputs[s].connections.splice(r,1),this.dispatch("connectionRemoved",{output_id:t,input_id:e,output_class:n,input_class:s}),!0}return!1}return!1}removeConnectionNodeId(t){const e="node_in_"+t,n="node_out_"+t,s=this.container.querySelectorAll("."+n);for(var o=s.length-1;o>=0;o--){var l=s[o].classList,r=this.drawflow.drawflow[this.module].data[l[1].slice(13)].inputs[l[4]].connections.findIndex(function(a,c){return a.node===l[2].slice(14)&&a.input===l[3]});this.drawflow.drawflow[this.module].data[l[1].slice(13)].inputs[l[4]].connections.splice(r,1);var p=this.drawflow.drawflow[this.module].data[l[2].slice(14)].outputs[l[3]].connections.findIndex(function(a,c){return a.node===l[1].slice(13)&&a.output===l[4]});this.drawflow.drawflow[this.module].data[l[2].slice(14)].outputs[l[3]].connections.splice(p,1),s[o].remove(),this.dispatch("connectionRemoved",{output_id:l[2].slice(14),input_id:l[1].slice(13),output_class:l[3],input_class:l[4]})}const d=this.container.querySelectorAll("."+e);for(o=d.length-1;o>=0;o--)l=d[o].classList,p=this.drawflow.drawflow[this.module].data[l[2].slice(14)].outputs[l[3]].connections.findIndex(function(a,c){return a.node===l[1].slice(13)&&a.output===l[4]}),this.drawflow.drawflow[this.module].data[l[2].slice(14)].outputs[l[3]].connections.splice(p,1),r=this.drawflow.drawflow[this.module].data[l[1].slice(13)].inputs[l[4]].connections.findIndex(function(a,c){return a.node===l[2].slice(14)&&a.input===l[3]}),this.drawflow.drawflow[this.module].data[l[1].slice(13)].inputs[l[4]].connections.splice(r,1),d[o].remove(),this.dispatch("connectionRemoved",{output_id:l[2].slice(14),input_id:l[1].slice(13),output_class:l[3],input_class:l[4]})}getModuleFromNodeId(t){var e;const n=this.drawflow.drawflow;return Object.keys(n).map(function(s,o){Object.keys(n[s].data).map(function(l,r){l==t&&(e=s)})}),e}addModule(t){this.drawflow.drawflow[t]={data:{}},this.dispatch("moduleCreated",t)}changeModule(t){this.dispatch("moduleChanged",t),this.module=t,this.precanvas.innerHTML="",this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_y=0,this.mouse_x=0,this.mouse_y=0,this.zoom=1,this.zoom_last_value=1,this.precanvas.style.transform="",this.import(this.drawflow,!1)}removeModule(t){this.module===t&&this.changeModule("Home"),delete this.drawflow.drawflow[t],this.dispatch("moduleRemoved",t)}clearModuleSelected(){this.precanvas.innerHTML="",this.drawflow.drawflow[this.module]={data:{}}}clear(){this.precanvas.innerHTML="",this.drawflow={drawflow:{Home:{data:{}}}}}export(){const t=JSON.parse(JSON.stringify(this.drawflow));return this.dispatch("export",t),t}import(t,e=!0){this.clear(),this.drawflow=JSON.parse(JSON.stringify(t)),this.load(),e&&this.dispatch("import","import")}on(t,e){return typeof e!="function"?(console.error("The listener callback must be a function, the given type is "+typeof e),!1):typeof t!="string"?(console.error("The event name must be a string, the given type is "+typeof t),!1):(this.events[t]===void 0&&(this.events[t]={listeners:[]}),void this.events[t].listeners.push(e))}removeListener(t,e){if(!this.events[t])return!1;const n=this.events[t].listeners,s=n.indexOf(e);s>-1&&n.splice(s,1)}dispatch(t,e){if(this.events[t]===void 0)return!1;this.events[t].listeners.forEach(n=>{n(e)})}getUuid(){for(var t=[],e=0;e<36;e++)t[e]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}}}]).default})})(Lt);const Ee=Se(Lt.exports),xt={LogicOperation:!0,Cicle:!0},St={Variable:!0,Assign:!0},gt=X(),wt=b=>b.nodeRefInput1&&b.nodeRefInput2,mt=(b,m)=>{const i=gt.getNode(b),y=gt.getNode(m);return{nodeRef1:i,nodeRef2:y}},vt=(b,m)=>{let i="";for(const y of b){const w=gt.getNode(y);w.type!=="MathOperation"&&(i+="	"+Et(m)+w.pythonCode+`
`)}return i},Et=b=>b?"	":"",ze={__name:"DrawFlowControll",setup(b){const m=at(it),i=X();m.on("nodeRemoved",function(n){i.removeNodeProgram(n)}),m.on("connectionCreated",function(n){const{type:s}=i.getNode(n.output_id);if(xt[s]){w(n);return}y(n)});const y=n=>{const s=i.getNode(n.input_id);if(n.input_class=="input_1"){s.nodeRefInput1=n.output_id;return}s.nodeRefInput2=n.output_id},w=n=>{const{nodeRef1:s,nodeRef2:o}=mt(n.output_id,n.input_id);o.parentNode=n.output_id,v(s,n)},v=(n,s)=>{if(n.type=="Cicle"){n.cicle.push(s.input_id);return}if(s.output_class=="output_1"){n.trueCondition.push(s.input_id);return}n.falseCondition.push(s.input_id)};m.on("connectionRemoved",function(n){const{type:s}=i.getNode(n.output_id);if(xt[s]){t(n);return}h(n)});const h=n=>{const s=i.getNode(n.input_id);if(n.input_class=="input_1"){s.nodeRefInput1=null;return}s.nodeRefInput2=null},t=n=>{const{nodeRef1:s,nodeRef2:o}=mt(n.output_id,n.input_id);o.parentNode=null,e(s,n)},e=(n,s)=>{if(n.type==="Cicle"){n.cicle=n.cicle.filter(o=>o!==s.input_id);return}if(s.output_class=="output_1"){n.trueCondition=n.trueCondition.filter(o=>o!==s.input_id);return}n.falseCondition=n.falseCondition.filter(o=>o!==s.input_id)};return(n,s)=>null}};const Ae={class:"flex justify-center items-center text-center py-1 bg-blue-100 border-b border-blue-900 rounded-t-xl"},Me={class:"title-color font-semibold ml-2"},He={class:"p-2 flex flex-col"},ut={__name:"BoxNode",props:{title:String},emits:["onNodeId"],setup(b,{emit:m}){const i=_t(null),y=_t(0);return Nt(async()=>{await Ot(),y.value=i.value.parentElement.parentElement.id.slice(5),m("onNodeId",y.value)}),(w,v)=>(D(),st("div",{class:"flex-col justify-center w-full",ref_key:"element",ref:i},[g("div",Ae,[yt(w.$slots,"icon"),g("h1",Me,lt(b.title),1)]),g("div",He,[yt(w.$slots,"content")])],512))}},$e=g("label",{for:"Identify",class:"text-blue-900 ml-2 font-medium"}," Identify ",-1),ke=g("label",{for:"Value",class:"text-blue-900 ml-2 pt-2 font-medium"},"Value",-1),qe={__name:"BoxVariable",setup(b){const m=X(),i=dt({type:"Variable",nodeId:"",identifier:"",value:0,parentNode:null,pythonCode:null}),y=at(it);m.addNodeProgram(i);const w=h=>{i.nodeId=h;const t=y.getNodeFromId(h);t.data.type&&(i.identifier=t.data.identifier,i.value=t.data.value,i.parentNode=t.data.parentNode,i.pythonCode=t.data.pythonCode)};rt(i,h=>{v(h)});const v=h=>{h.identifier?h.pythonCode=`${h.identifier} = ${h.value}`:h.pythonCode=null};return(h,t)=>(D(),ct(ut,{title:"Variable",onOnNodeId:t[2]||(t[2]=e=>w(e))},{icon:U(()=>[x(P(Ft),{class:"title-color font-semibold text-lg"})]),content:U(()=>[$e,pt(g("input",{type:"text",id:"Identify",name:"Identify",class:"border-2 border-blue-200 rounded-lg px-2 py-1 text-sm text-blue-900 focus:border-blue-400 focus:outline-none",placeholder:"Identify to Variable","onUpdate:modelValue":t[0]||(t[0]=e=>i.identifier=e)},null,512),[[ft,i.identifier]]),ke,pt(g("input",{type:"number",id:"Value",name:"Value",class:"border-2 border-blue-200 rounded-lg px-2 py-1 text-sm text-blue-900 focus:border-blue-400 focus:outline-none",placeholder:"Numerical Value","onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e)},null,512),[[ft,i.value]])]),_:1}))}},Oe=g("label",{for:"Identify",class:"text-blue-900 ml-2 font-medium"},"Identify",-1),Pe=g("label",{for:"Value",class:"text-blue-900 ml-2 font-medium pt-2"},"Value",-1),Ve={__name:"BoxAssign",setup(b){const m=X(),i=dt({type:"Assign",nodeId:"",identifier:"",nodeRefInput1:null,value:null,parentNode:null,pythonCode:null}),y=at(it);m.addNodeProgram(i);const w=e=>{i.nodeId=e;const n=y.getNodeFromId(e);n.data.type&&(i.identifier=n.data.identifier,i.nodeRefInput1=n.data.nodeRefInput1,i.value=n.data.value,i.parentNode=n.data.parentNode,i.pythonCode=n.data.pythonCode)};rt(i,e=>{v(e.nodeRefInput1),h(e)});const v=e=>{const n=m.getNode(e);n?i.value=n.value:i.value=null},h=e=>{const n=m.getNode(e.nodeRefInput1);if(n){e.pythonCode=t(e,n);return}e.pythonCode=null},t=(e,n)=>St[n.type]?`${e.identifier} = ${n.identifier}`:`${e.identifier} = ${n.pythonCode}`;return(e,n)=>(D(),ct(ut,{title:"Assign",onOnNodeId:n[2]||(n[2]=s=>w(s))},{icon:U(()=>[x(P(Wt),{class:"title-color font-semibold text-lg"})]),content:U(()=>[Oe,pt(g("input",{type:"text",id:"Identify",name:"Identify",class:"border-2 border-blue-200 rounded-lg px-2 py-1 text-sm text-blue-900 focus:border-blue-400 focus:outline-none",placeholder:"Identify to Assign","onUpdate:modelValue":n[0]||(n[0]=s=>i.identifier=s)},null,512),[[ft,i.identifier]]),Pe,pt(g("input",{type:"number",id:"Value",name:"Value",class:"border-2 border-blue-200 rounded-lg px-2 py-1 text-sm text-blue-900 focus:border-blue-400 focus:outline-none","onUpdate:modelValue":n[1]||(n[1]=s=>i.value=s),disabled:""},null,512),[[ft,i.value]])]),_:1}))}},je={class:"text-center"},De=g("h1",{class:"title-color font-semibold"},"Value 1",-1),We={class:"flex justify-between text-2xl my-3 text-blue-900"},Fe=g("h1",{class:"title-color font-semibold"},"Value 2",-1),Te={__name:"BoxMath",setup(b){const m=X(),i=dt({type:"MathOperation",nodeId:"",operation:"+",nodeRefInput1:null,nodeRefInput2:null,value:null,parentNode:null,pythonCode:null}),y=at(it);m.addNodeProgram(i);const w=h=>{i.nodeId=h;const t=y.getNodeFromId(h);t.data.type&&(i.operation=t.data.operation,i.nodeRefInput1=t.data.nodeRefInput1,i.nodeRefInput2=t.data.nodeRefInput2,i.value=t.data.value,i.parentNode=t.data.parentNode,i.pythonCode=t.data.pythonCode)};rt(i,h=>{if(wt(h))return v(h);h.pythonCode=null,h.value=null});const v=h=>{const{nodeRef1:t,nodeRef2:e}=mt(h.nodeRefInput1,h.nodeRefInput2);switch(h.pythonCode=`${t.identifier} ${h.operation} ${e.identifier}`,h.operation){case"+":h.value=t.value+e.value;break;case"-":h.value=t.value-e.value;break;case"*":h.value=t.value*e.value;break;case"/":h.value=t.value/e.value;break;case"%":h.value=t.value%e.value;break;default:h.value=null;break}};return(h,t)=>(D(),ct(ut,{title:"Math Operation",onOnNodeId:t[5]||(t[5]=e=>w(e))},{icon:U(()=>[x(P(Tt),{class:"title-color font-semibold text-lg"})]),content:U(()=>[g("div",je,[De,g("div",We,[g("span",{class:tt(["hover:bg-blue-400 hover:text-white p-1 rounded-lg",i.operation=="+"?"bg-blue-900 text-white":""]),onClick:t[0]||(t[0]=e=>i.operation="+")},[x(P(Jt))],2),g("span",{class:tt(["hover:bg-blue-400 hover:text-white p-1 rounded-lg",i.operation=="-"?"bg-blue-900 text-white":""]),onClick:t[1]||(t[1]=e=>i.operation="-")},[x(P(Ut))],2),g("span",{class:tt(["hover:bg-blue-400 hover:text-white p-1 rounded-lg",i.operation=="*"?"bg-blue-900 text-white":""]),onClick:t[2]||(t[2]=e=>i.operation="*")},[x(P(Qt))],2),g("span",{class:tt(["hover:bg-blue-400 hover:text-white p-1 rounded-lg",i.operation=="/"?"bg-blue-900 text-white":""]),onClick:t[3]||(t[3]=e=>i.operation="/")},[x(P(Kt))],2),g("span",{class:tt(["hover:bg-blue-400 hover:text-white p-1 rounded-lg",i.operation=="%"?"bg-blue-900 text-white":""]),onClick:t[4]||(t[4]=e=>i.operation="%")},[x(P(Yt))],2)]),Fe])]),_:1}))}},Ue={class:"text-center"},Xe=g("div",{class:"flex justify-between pl-6"},[g("h1",{class:"title-color font-semibold"},"Value 1"),g("h1",{class:"title-color font-semibold"},"True")],-1),Ye={class:"flex justify-between items-center px-1 my-3 mr-8 text-2xl text-blue-900"},Je=g("div",{class:"flex justify-between pl-6"},[g("h1",{class:"title-color font-semibold"},"Value 2"),g("h1",{class:"title-color font-semibold"},"False")],-1),Ze={__name:"BoxLogic",setup(b){const m=X(),i=dt({type:"LogicOperation",nodeId:"",operation:"==",nodeRefInput1:null,nodeRefInput2:null,trueCondition:[],falseCondition:[],parentNode:null,pythonCode:null}),y=at(it);m.addNodeProgram(i);const w=t=>{i.nodeId=t;const e=y.getNodeFromId(t);e.data.type&&(i.operation=e.data.operation,i.nodeRefInput1=e.data.nodeRefInput1,i.nodeRefInput2=e.data.nodeRefInput2,i.trueCondition=e.data.trueCondition,i.falseCondition=e.data.falseCondition,i.parentNode=e.data.parentNode,i.pythonCode=e.data.pythonCode)};rt(i,t=>{v(t)});const v=t=>{if(wt(t)){t.pythonCode=h(t);return}t.pythonCode=null},h=t=>{const{nodeRef1:e,nodeRef2:n}=mt(t.nodeRefInput1,t.nodeRefInput2);return"if "+e.identifier+" "+t.operation+" "+n.identifier+`:
`+vt(t.trueCondition,t.parentNode)+`
`+Et(t.parentNode)+`else:
`+vt(t.falseCondition,t.parentNode)};return(t,e)=>(D(),ct(ut,{title:"Logic Operation",onOnNodeId:e[4]||(e[4]=n=>w(n))},{icon:U(()=>[x(P(Gt),{class:"title-color font-bold text-lg"})]),content:U(()=>[g("div",Ue,[Xe,g("div",Ye,[g("span",{value:"Add",class:tt(["hover:bg-blue-400 hover:text-white rounded-lg w-8 h-8 font-bold border-2 border-blue-900",i.operation=="<"?"bg-blue-900 text-white":""]),onClick:e[0]||(e[0]=n=>i.operation="<")}," < ",2),g("span",{value:"Subtract",class:tt(["hover:bg-blue-400 hover:text-white rounded-lg w-8 h-8 after:first:font-bold border-2 border-blue-900",i.operation==">"?"bg-blue-900 text-white":""]),onClick:e[1]||(e[1]=n=>i.operation=">")}," > ",2),g("span",{value:"Multiply",class:tt(["hover:bg-blue-400 hover:text-white rounded-lg w-8 h-8 font-bold border-2 border-blue-900",i.operation=="!="?"bg-blue-900 text-white":""]),onClick:e[2]||(e[2]=n=>i.operation="!=")}," != ",2),g("span",{value:"Divide",class:tt(["hover:bg-blue-400 hover:text-white rounded-lg w-8 h-8 font-bold border-2 border-blue-900",i.operation=="=="?"bg-blue-900 text-white":""]),onClick:e[3]||(e[3]=n=>i.operation="==")}," = ",2)]),Je])]),_:1}))}},Ge={class:"flex flex-col items-center"},Ke=g("h1",{class:"title-color font-semibold"},"From",-1),Qe=g("h1",{class:"title-color font-semibold"},"To",-1),tn={__name:"BoxCicle",setup(b){const m=X(),i=dt({type:"Cicle",nodeId:"",nodeRefInput1:null,nodeRefInput2:null,cicle:[],parentNode:null,pythonCode:null}),y=at(it);m.addNodeProgram(i);const w=t=>{i.nodeId=t;const e=y.getNodeFromId(t);e.data.type&&(i.nodeRefInput1=e.data.nodeRefInput1,i.nodeRefInput2=e.data.nodeRefInput2,i.cicle=e.data.cicle,i.parentNode=e.data.parentNode,i.pythonCode=e.data.pythonCode)};rt(i,t=>{v(t)});const v=t=>{if(wt(t)){t.pythonCode=h(t);return}t.pythonCode=null},h=t=>{const{nodeRef1:e,nodeRef2:n}=mt(t.nodeRefInput1,t.nodeRefInput2);return"for i in range( "+e.identifier+", "+n.identifier+` + 1 ):
`+vt(t.cicle,t.parentNode)};return(t,e)=>(D(),ct(ut,{title:"Cicle",onOnNodeId:e[0]||(e[0]=n=>w(n))},{icon:U(()=>[x(P(bt),{class:"title-color font-semibold text-lg"})]),content:U(()=>[g("div",Ge,[Ke,x(P(bt),{class:"title-color font-bold text-2xl my-1"}),Qe])]),_:1}))}},en={class:"flex flex-col items-center"},nn=g("label",{for:"Identify",class:"text-blue-900 ml-2 font-medium"},"Message",-1),on=g("h1",{class:"title-color font-semibold mt-2"},"Value to Print",-1),sn={class:"title-color font-semibold mt-2"},an={__name:"BoxPrint",setup(b){const m=X(),i=dt({type:"Print",nodeId:"",message:"",nodeRefInput1:null,value:null,parentNode:null,pythonCode:null}),y=at(it);m.addNodeProgram(i);const w=e=>{i.nodeId=e;const n=y.getNodeFromId(e);n.data.type&&(i.message=n.data.message,i.nodeRefInput1=n.data.nodeRefInput1,i.value=n.data.value,i.parentNode=n.data.parentNode,i.pythonCode=n.data.pythonCode)};rt(i,e=>{v(e.nodeRefInput1),h(e)});const v=e=>{const n=m.getNode(e);n?i.value=n.value:i.value=null},h=e=>{const n=m.getNode(e.nodeRefInput1);if(n){e.pythonCode=t(e,n);return}e.pythonCode=`print("${e.message}")`},t=(e,n)=>St[n.type]?`print("${e.message}" , ${n.identifier})`:`print("${e.message}" , ${n.pythonCode})`;return(e,n)=>(D(),ct(ut,{title:"Print",onOnNodeId:n[1]||(n[1]=s=>w(s))},{icon:U(()=>[x(P(Zt),{class:"title-color font-semibold text-lg"})]),content:U(()=>[g("div",en,[nn,pt(g("input",{type:"text",id:"Identify",name:"Identify",class:"border-2 border-blue-200 rounded-lg px-2 py-1 text-sm text-blue-900 focus:border-blue-400 focus:outline-none",placeholder:"Message to Print","onUpdate:modelValue":n[0]||(n[0]=s=>i.message=s)},null,512),[[ft,i.message]]),on,g("h1",sn,lt(i.value),1)])]),_:1}))}};const ln={key:1,class:"absolute bottom-0 right-0 bg-color w-1/3 h-1/2 px-5 pb-2 z-10 text-white rounded-tl-xl font"},dn={class:"sticky top-0 border-b bg-color pt-2 flex justify-between items-center"},rn=W(" Terminal Code:Node/home/board@ "),cn={readonly:"readonly",class:"w-full h-5/6 bg-color text-white p-1 focus:outline-0"},un={__name:"Terminal",setup(b){const m=X(),i=_t(!0);return(y,w)=>{const v=ht("font-icon");return i.value==!1?(D(),st("button",{key:0,class:"absolute bottom-5 right-5 z-10 bg-color text-white p-3 rounded-lg transition duration-300 hover:bg-blue-900",onClick:w[0]||(w[0]=h=>i.value=!i.value)},[x(v,{icon:"fa-solid fa-terminal"})])):(D(),st("div",ln,[g("div",dn,[x(v,{icon:"fa-solid fa-terminal"}),rn,g("button",{class:"transition duration-300 hover:bg-blue-900 p-1 rounded-md m-1",onClick:w[1]||(w[1]=h=>i.value=!i.value)},[x(v,{icon:"fa-regular fa-rectangle-xmark",class:"text-xl"})])]),g("textarea",cn,lt(P(m).pythonCode)+`\r
    `,1)]))}}},hn=It(un,[["__scopeId","data-v-c0b1c33c"]]),pn=[{name:"variable",in:1,out:1},{name:"assign",in:1,out:1},{name:"math",in:2,out:1},{name:"logic",in:2,out:2},{name:"cicle",in:2,out:1},{name:"print",in:1,out:0}],fn={__name:"MainBoard",setup(b){const m=Pt({}),i={version:3,h:Rt,render:jt},y=it();y.appContext.app._context.config.globalProperties.$df=m;const w=Vt(pn),v=Bt("emitter"),h=X();Nt(()=>{const o=document.getElementById("drawflow");m.value=new Ee(o,i,y.appContext.app._context),m.value.reroute=!0,m.value.start(),n(),m.value.import(h.drawflowProgram)}),v.on("saveProgram",()=>{let o=m.value.export();h.drawflowProgram=o});const t=o=>{o.preventDefault();let l=o.dataTransfer.getData("node");const r=w.find(a=>a.name==l);let{x:p,y:d}=s(o.clientX,o.clientY);m.value.addNode(r.name,r.in,r.out,p,d,r.name,{},r.name,"vue")},e=o=>{o.preventDefault()},n=()=>{m.value.registerNode("variable",qe,{},{}),m.value.registerNode("assign",Ve,{},{}),m.value.registerNode("math",Te,{},{}),m.value.registerNode("logic",Ze,{},{}),m.value.registerNode("cicle",tn,{},{}),m.value.registerNode("print",an,{},{}),m.value.registerNode("DfControl",ze,{},{}),m.value.addNode("DfControl",0,0,0,0,"dfcontrol",{},"DfControl","vue")};function s(o,l){let r=o*(m.value.precanvas.clientWidth/(m.value.precanvas.clientWidth*m.value.zoom))-m.value.precanvas.getBoundingClientRect().x*(m.value.precanvas.clientWidth/(m.value.precanvas.clientWidth*m.value.zoom)),p=l*(m.value.precanvas.clientHeight/(m.value.precanvas.clientHeight*m.value.zoom))-m.value.precanvas.getBoundingClientRect().y*(m.value.precanvas.clientHeight/(m.value.precanvas.clientHeight*m.value.zoom));return{x:r,y:p}}return(o,l)=>(D(),st("div",{id:"drawflow",onDrop:l[0]||(l[0]=r=>t(r)),onDragover:l[1]||(l[1]=r=>e(r))},[x(hn),x(Ht)],32))}},mn={class:"flex"},_n={class:"flex-col w-full"},wn={__name:"Board",setup(b){return(m,i)=>(D(),st("div",mn,[x(_e),g("div",_n,[x(Ne),x(fn)])]))}};export{wn as default};
